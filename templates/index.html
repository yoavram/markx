{% extends "base.html" %}

{% block header %}

<div class="span12" style="line-height: 40px;">
	<a class="brand" href="/" rel="tooltip" title="Karl Heinrich Marx, 1818 â€“ 1883">
		<img class="img-rounded" alt="Markx" title="Markx" alt="Markx"src="/static/karl-marx-160x40.png">
		</a>
		<div class="btn-toolbar">
		<input class="input-small" type="text" id="filename" placeholder="file name" style="margin: auto 5px">	
		<button class="btn" id="btn-display-panels">Display</button>
		<button class="btn" id="btn-load-md">Load .md</button>
		<button class="btn" id="btn-save-md">Save .md</button>
		<button class="btn" id="btn-save-bibtex">Save .bib</button>
		<button class="btn" id="btn-save-pdf">Save .pdf</button>
		<button class="btn" id="btn-save-docx">Save .docx</button>
		<button class="btn" id="btn-citations"  rel="tooltip" title="Update citations list">Citations</button>
		<div class="btn-group">
			<button class="btn dropdown-toggle" data-toggle="dropdown" rel="tooltip" title="Change code highlighting theme">
				Highlight
				<span class="caret"></span>
			</button>
			<ul class="dropdown-menu">
				{% for style in config.PRETTIFY_STYLESHEETS %}
				<li><a href='#' class="btn-prettify">{{ style }}</a></li>
				{% endfor %}
			</ul>
		</div>
	</div>
</div>

{% endblock header %}

{% block left %}


<div class="wmd-panel" id="editor-panel">
	<div id="wmd-button-bar-second"></div>
	<textarea class="wmd-input" id="wmd-input-second">
# Markx

*Marx* is a [Markdown] editor with [Pandoc] flavor in your browser.

## Features

1. Zenware
1. Display math - $x^2+y^2=r^2$
1. Markdown flavor of Pandoc
1. Citations using Pandoc/BibTeX: [@Drake1991]
1. Code highlighting:

		if __name__ == '__main__':
			# Bind to PORT if defined, otherwise default to 5000.
			port = int(os.environ.get('PORT', 5000))
			app.run(host='0.0.0.0', port=port, debug=app.debug)


## Technology

  * [Python] with [Flask]
  * [PageDown] markdown editor
  * [Twitter Bootstrap] with [Glyphicons Free]
  * [Google Code Prettifier]
  * [MathJax]
  * [BibTeX-js]

## References

[Markdown]: http://daringfireball.net/projects/markdown/
[Pandoc]: http://johnmacfarlane.net/pandoc
[Python]: http://python.org/
[Flask]: http://flask.pocoo.org/
[Twitter Bootstrap]: http://blog.getbootstrap.com/
[Google Code Prettifier]: http://code.google.com/p/google-code-prettify/
[Glyphicons Free]: http://glyphicons.com/
[MathJax]: http://mathjax.org/
[PageDown]: http://code.google.com/p/pagedown/
[BibTeX-js]: http://bibtex-js.googlecode.com/
	</textarea>
</div>
{% endblock left %}

{% block right %}
<div id="preview-panel">
	<div id="wmd-preview-second" class="wmd-panel wmd-preview"></div>
	<div id="bibtex_display" class="wmd-panel wmd-preview">
	</div>
</div>
{% endblock right %}	

{% block footer %}

<script type="text/javascript">
/* markdown editor */
var editor = init_markdown_editor();

/* citations */
$("#btn-citations").click(updateCitations);
updateCitations();

/* code highlighting stuff */
$(function() {
	$('.btn-prettify').click(function() {
		$('#prettify-style').attr('href','/static/prettify/' + $(this).text() + '.css');
		prettyPrintOne();
	});
})
prettyPrintOne();

/* files */
$(function() {
	$('#btn-save-md').click(function() {
		var content = $('textarea#wmd-input-second').val();
		var filename = $('#filename').val() || 'markx';
		download(content, filename, 'md');
	});
	$('#btn-save-bibtex').click(function() {
		var content = $('textarea#bibtex_input').val();
		var filename = $('#filename').val() || 'markx';
		download(content, filename, 'bib');
	});
	$('#btn-save-pdf').click(function() {
		var content = $('textarea#wmd-input-second').val();
		var filename = $('#filename').val() || 'markx';
		download(content, filename, 'pdf');
	});
	$('#btn-save-docx').click(function() {
		var content = $('textarea#wmd-input-second').val();
		var filename = $('#filename').val() || 'markx';
		download(content, filename, 'docx');
	});

	$('#btn-load-md').click(function() {
		$('#fileinput').click();
	});
	document.getElementById('fileinput').addEventListener('change', readSingleFile, false);
})
/* display */
var panelsDisplayStatus = 'dual';
$(function() {
	$('#btn-display-panels').click(panelsDisplay);
})
</script>
<input type="file" id="fileinput" style="display:none;"/>
<textarea id="bibtex_input" style="display:none;">

</textarea>
{%endblock footer %}	